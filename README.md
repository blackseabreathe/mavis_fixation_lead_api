# –ú–∞–≤–∏—Å, API —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ª–∏–¥–æ–≤
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç API –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–∏–¥. –û—Ç–≤–µ—Ç—ã –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —Å–ª—É—á–∞–∏ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –ø—Ä–æ–≤–µ—Ä–∫—É —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ —Å—Ç–∞—Ç—É—Å —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ª–∏–¥–∞.

## –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞
```json
{
  "result": [boolean],
  "error": [int],         // –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ
  "message": [string],    // –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
  "fixation_deadline": [string|null] // –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ª–∏–¥–∞
}
```

## üü° –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∑–∞–ø—Ä–æ—Å–∞ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ X-AGENT-TOKEN

–ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥–æ–º `GET`. 


### ‚ùå –û—à–∏–±–∫–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ (400, 401, 405)

#### 1. –û—Ç–ø—Ä–∞–≤–ª–µ–Ω –∑–∞–ø—Ä–æ—Å –º–µ—Ç–æ–¥–æ–º, –æ—Ç–ª–∏—á–Ω—ã–º –æ—Ç `GET`
```
{
  "result": false,
  "error": 405,
  "message": "Request method is not supported"
}
```

#### 2. –ù–µ –ø–µ—Ä–µ–¥–∞–Ω —Ç–æ–∫–µ–Ω
```
{
  "result": false,
  "error": 401,
  "message": "Token is missing"
}
```

#### 3. –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω
```
{
  "result": false,
  "error": 400,
  "message": "Token is incorrect"
}
```

#### 4. –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –ø—É—Å—Ç–æ–µ
```
{
  "result": false,
  "error": 400,
  "message": "No data was transferred"
}
```




### ‚ùå –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (400)

#### 1. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞
```
{
  "result": false,
  "error": 400,
  "message": "Client name is too short"
}
```

#### 2. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∞–º–∏–ª–∏—è –∫–ª–∏–µ–Ω—Ç–∞:
```
{
  "result": false,
  "error": 400,
  "message": "Client surname is too short"
}
```

#### 3. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ –º–µ–Ω–µ–µ 11 —Ü–∏—Ñ—Ä:
```
{
  "result": false,
  "error": 400,
  "message": "Phone must consist of 11 digits"
}
```

#### 4. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–º—è –∞–≥–µ–Ω—Ç–∞:
```
{
  "result": false,
  "error": 400,
  "message": "Agent name is too short"
}
```

#### 5. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω –∞–≥–µ–Ω—Ç–∞ –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ –º–µ–Ω–µ–µ 11 —Ü–∏—Ñ—Ä:
```
{
  "result": false,
  "error": 400,
  "message": "Agent phone must consist of 11 digits"
}
```

#### 6. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞:
```
{
  "result": false,
  "error": 400,
  "message": "Agency name is too short"
}
```



### ‚ö†Ô∏è –°—Ç–∞—Ç—É—Å—ã —Ñ–∏–∫—Å–∞—Ü–∏–∏ (200, 208, 406)

#### 1. –¢–µ–ª–µ—Ñ–æ–Ω –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏ –ª–∏–¥ –ù–ï –Ω–∞ —Å—Ç–∞–¥–∏–∏ –§–∏–∫—Å–∞—Ü–∏—è:
```
{
  "result": false,
  "error": 406,
  "message": "not unique"
}
```

#### 2. –¢–µ–ª–µ—Ñ–æ–Ω –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã–π, –ª–∏–¥ –Ω–∞ —Å—Ç–∞–¥–∏–∏ –§–∏–∫—Å–∞—Ü–∏—è:
```
{
  "result": false,
  "error": 208,
  "message": "Lead was already fixed",
  "fixation_deadline": "2025-07-03 20:00:00"
}
```


### 3. –¢–µ–ª–µ—Ñ–æ–Ω —É–Ω–∏–∫–∞–ª–µ–Ω, —É—Å–ø–µ—à–Ω–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è:
```
{
  "result": true,
  "message": "unique",
  "fixation_deadline": "2025-07-03 20:00:00"
}
```

–í–æ –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–∞—Ö HTTP —Å—Ç–∞—Ç—É—Å –∏–¥–µ–Ω—Ç–∏—á–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä—É `error`, –∫—Ä–æ–º–µ —É—Å–ø–µ—à–Ω–æ–π —Ñ–∏–∫—Å–∞—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∞–≥–µ–Ω—Ç–∞, –≤ –æ—Ç–≤–µ—Ç–µ –ø–æ–ª—É—á–∏–ª–∏ `{... "error": 400, ...}`, –∑–Ω–∞—á–∏—Ç –∏ HTTP —Å—Ç–∞—Ç—É—Å —Ç–æ–∂–µ 400.

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π —Ñ–∏–∫—Å–∞—Ü–∏–∏ 
```diff 
+ HTTP —Å—Ç–∞—Ç—É—Å - 200
```
–ø–∞—Ä–∞–º–µ—Ç—Ä `error` –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è.

–í –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `message` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏


# Curl –ø—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```diff
- –í–Ω–∏–º–∞–Ω–∏–µ! –ï—Å—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∑–∞–ø—Ä–æ—Å–µ
```

```
$endpoint = 'https://crm02.r2d.ru/local/samoliot-app/lead-fixation/fixation/v2/';

$params = [
    "phone" => "+7 (912) 000-00-11", // –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞, –ª—é–±–æ–π —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –Ω–æ —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ 11 —Ü–∏—Ñ—Ä (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
    "surname" => "–ë–µ–∑—Ñ–∞–º–∏–ª—å–Ω—ã–π", // –§–∞–º–∏–ª–∏—è –∫–ª–∏–µ–Ω—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
    "name" => "–ë–µ–∑–∏–º—è–Ω", // –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
    "middleName" => "–ë–µ–∑–æ—Ç—á–µ—Å—Ç–≤–æ–≤–∏—á", // –û—Ç—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–∞
    "agency" => "–ú–∏-6", // –ù–∞–∑–≤–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
    "agent" => [
        "name" => "–ê–≥–µ–Ω—Ç –î–∂–µ–π–º—Å –ë–æ–Ω–¥ 007", // –ò–º—è –∞–≥–µ–Ω—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
        "phone" => "7 900 232 52-23", // –¢–µ–ª–µ—Ñ–æ–Ω –∞–≥–µ–Ω—Ç–∞, –ª—é–±–æ–π —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –Ω–æ —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ 11 —Ü–∏—Ñ—Ä (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
    ],
];

// –ó–∞–≥–æ–ª–æ–≤–∫–∏
$headers = [
    'Accept: application/json', // —Ñ–æ—Ä–º–∞—Ç JSON
    'Content-Type: application/json', // —Ñ–æ—Ä–º–∞—Ç JSON
    'X-AGENT-TOKEN: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx'
];


$curl = curl_init();
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_URL, $endpoint.'?'.http_build_query($params));
curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);

$result = json_decode(curl_exec($curl), true);
if (curl_errno($curl)) {
    echo '–û—à–∏–±–∫–∞ cURL: ' . curl_error($curl);
}

$http_code = curl_getinfo($curl, CURLINFO_HTTP_CODE); // –ø–æ–ª—É—á–∏–º HTTP —Å—Ç–∞—Ç—É—Å
curl_close($curl);

echo "http code: $http_code<br><br><br>";

echo '<pre>';
print_r($result);
```
